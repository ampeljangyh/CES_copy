 <!DOCType html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, user-scalable=0">
<meta name="msapplication-TileColor" content="#4D6EDB">
<meta property="og:title" content="">
<meta property="og:description" content="">
<meta property="og:Type" content="website">
<meta property="og:image" content="../../resources/images/">
<title></title>
<link rel="shortcut icon" href="../../resources/images/" type="image/x-icon">
<link rel="apple-touch-icon" href="../../resources/images/">
<link rel="stylesheet" href="../../resources/css/style.css">
<link rel="stylesheet" href="../../resources/css/swiper-bundle.min.css">

<!-- 퍼블리싱 -->
<script src="../../resources/js/jquery-3.7.1.min.js"></script>
<script src="../../resources/js/jquery-ui.js"></script>
<script src="../../resources/js/swiper-bundle.min.js"></script>
<script src="../../resources/js/chart.js"></script>
<script src="../../resources/js/chartjs-plugin-datalabel.js"></script>
<!-- //퍼블리싱 -->
</head>

<body class="gate_01_01">
<!-- wrap -->
<div id="wrap" class="com_bg gate_01_main">
    <!-- Header -->
    <header>
    </header>
    <!-- //Header -->

    <!-- Container -->
    <section id="container" class="gate_02 sub">
        <div class="snb">
            <div class="snb_inner">
                <a href="../main.html" class="logo">
                    <img src="../../resources/images/logo.png">
                </a>
                <div class="menu">
                    <ul>
                        <li>
                            <a href="../main.html" class="menu_item ico_01">메인</a>
                        </li>
                        <li>
                            <a href="../gate01/gate_01.html" class="menu_item ico_02">기술 금융 시스템</a>
                        </li>
                        <li>
                            <a href="../gate02/gate_02.html" class="menu_item ico_03 active">K-콘텐츠 투자</a>
                        </li>
                        <li>
                            <a href="../gate03/gate_03.html" class="menu_item ico_04">ESG 정밀진단 시스템</a>
                        </li>
                    </ul>
                </div>
                <div class="lang">
                    <button type="button" class="btn_lang">
                        <span class="en">English</span>
                        <span class="kr">한국어</span>
                    </button>
                </div>
            </div>
        </div>
 
        <div class="contents gate_02_04">
            <div iv class="inve_confirm_wrap">
                <div class="inve_inner">
                    <div class="pg_tit">
                        <strong>영화 상영 중</strong>
                        <p>
                            영화가 상영 중입니다. 영화 상영 기간이 끝나면 최종 투자 결과 및 수익률을 확인할 수 있습니다.<br>
                            영화가 상영되는 동안 <span class="cl_01">해당 영화에 대한 IBK 투자 포인트를 확인</span>해보세요.
                        </p>
                    </div>

                    <div class="film_box">
                        <video src="../../resources/images/gate_02/film.mp4" autoplay muted loop playsinline></video>
                    </div>

                    <div class="inve_confirm_box">
                        <div class="shiny_step dot_cs">
                            <ul>
                                <li class="on">
                                </li>
                                <li>
                                </li>
                                <li>
                                </li>
                            </ul>
                        </div>
                        <div class="inve_confirm_tit">
                            <strong>투자 적격 여부</strong>
                            <p>
                                모든 항목에서 적합해야 투자 검토 대상으로 선정됩니다.
                            </p>
                        </div>
                        <div class="inve_confirm_list">
                            <ul>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>투자 대상</strong>
                                            <span>중소·중견기업 기획 제작 여부</span>
                                        </div>
                                        <div class="confirm">
                                            
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>외부 의견</strong>
                                            <span>과반수 이상 동의 여부</span>
                                        </div>
                                        <div class="confirm">
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>영화 소재</strong>
                                            <span>투자 적합 소재 여부</span>
                                        </div>
                                        <div class="confirm">
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>참여 인력</strong>
                                            <span>영화 관련 당사자들의 사회적 문제 미보유 여부</span>
                                        </div>
                                        <div class="confirm">
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div class="final_confirm">
                            <div class="final_gp">
                                <div class="final_label">최종평가</div>
                                <div class="final_bar">
                                    <div class="final_cursor">
                                        <div class="cursor_knob"></div>
                                        <div class="cursor_line"></div>
                                        <div class="cursor_text">적합</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="inve_examine_box">
                        <div class="inve_examine_inner">
                            <div class="shiny_step dot_cs">
                                <ul>
                                    <li>
                                    </li>
                                    <li class="on">
                                    </li>
                                    <li>
                                    </li>
                                </ul>
                            </div>
                            <div class="inve_examine_tit">
                                <strong>투자 여부 검토 </strong>
                                <p>
                                    투자 적격 여부를 통과한 영화는<br>
                                    세부적인 평가 요소들을 검토하여 최종 투자 여부 및 투자금액을 산정합니다.
                                </p>
                            </div>

                            <div class="inve_gp_set">
                                <div class="inve_examine_content">
                                    <div class="inve_examine_step">
                                        <div class="step_examine_list">
                                            <ul>
                                                <li>
                                                    <div class="step_examine_01" data-target="examine01">
                                                        <span class="step_num">01</span>
                                                        <span>시나리오</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="step_examine_02">
                                                        <span class="step_num">02</span>
                                                        <span>감독</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="step_examine_03">
                                                        <span class="step_num">03</span>
                                                        <span>배우</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="step_examine_04">
                                                        <span class="step_num">04</span>
                                                        <span>제작사 역량</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="step_examine_05">
                                                        <span class="step_num">05</span>
                                                        <span>배급</span>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="step_examine_06">
                                                        <span class="step_num">06</span>
                                                        <span>투자</span>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="inve_examine_gp">
                                        <div class="inve_examine_step_01" id="examine01">
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>시나리오 내용</strong>
                                                    <p>시나리오 회의 결과</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="80"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>관람 등급</strong>
                                                    <p>12세 관람등급 등</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>장르</strong>
                                                    <p>코미디, 액션 등</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="80"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                        
                                        <div class="inve_examine_step_02" id="examine02">
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>감독경력(흥행성)</strong>
                                                    <p>최근 3개 작품 관객수</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="70"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>동 장르 연출경험</strong>
                                                    <p>관객 동원 능력</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="80"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                        
                                        <div class="inve_examine_step_03" id="examine03">
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>주연배루 흥행성</strong>
                                                    <p>최근 3개 작품의 관객 동원치</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>조연배우 흥행성</strong>
                                                    <p>출연 영화 관객수</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>

                                        <div class="inve_examine_step_04" id="examine04">
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>제작사 흥행실력</strong>
                                                    <p>최근 3년간 작품 관객수</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>PD 등 주요인력</strong>
                                                    <p>6개 분야 감독의 평균점수</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>

                                        <div class="inve_examine_step_05" id="examine05">
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>배급시기</strong>
                                                    <p>배급사의 개봉시기 선택</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>배급사 경험치</strong>
                                                    <p>배급사의 전년도 관객점유율</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="80"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>경쟁작품 현황</strong>
                                                    <p>경쟁작춤 분석</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>

                                        <div class="inve_examine_step_06" id="examine06">
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>총제작비</strong>
                                                    <p>총제작비 수준</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>투자시기</strong>
                                                    <p>작품 진행 현황에 따른 시기</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="100"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                            <div class="inve_examine_gp_item">
                                                <div class="txt">
                                                    <strong>투자비중 현황</strong>
                                                    <p>주요 관계사 투자비중</p>
                                                </div>
                                                <div class="gp_item">
                                                    <div class="bar">
                                                        <span class="gauge" data-percent="80"></span>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                    </div>
                                </div>
                                <div class="chart_radar">
                                    <div class="chart_radar_inner">
                                        <div class="radar_wrap">
                                            <canvas id="movieRadar"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="final_confirm">
                                <div class="tit">
                                    <strong>최종평가</strong>
                                </div>
                                <div class="final_gp">
                                    <div class="final_label">최종평가</div>
                                    <div class="final_bar">
                                        <div class="final_cursor">
                                            <div class="cursor_knob"></div>
                                            <div class="cursor_line"></div>
                                            <div class="cursor_text p01">비적합</div>
                                            <div class="cursor_text p02">기준 충족</div>
                                            <div class="cursor_text p03">적합</div>
                                            <div class="cursor_text p04">매우 적합</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="inve_adj_box">
                        <div class="shiny_step">
                            <ul>
                                <li>
                                </li>
                                <li>
                                </li> 
                                <li class="on">
                                </li>
                            </ul>
                        </div>
                        <div class="inve_adj_tit">
                            <strong>조정계수 반영</strong>
                            <p>
                                마지막으로 조건 및 상황 등 조정계수를 반영하여<br>
                                최종 투자 여부 및 투자금액을 산정합니다.
                            </p>
                        </div>
                        <div class="inve_adj_list">
                            <ul>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>입봉작 여부</strong>
                                            <span>감독이 30대, 40대에 해당하는 경우</span>
                                        </div>
                                        <div class="confirm">
                                            <div class="btn_set">
                                                <span>YES</span>
                                                <span>NO</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>직전작 흥행 여부</strong>
                                            <span>감독의 직전작이 흥행에 크게 실패한 경우</span>
                                        </div>
                                        <div class="confirm">
                                            <div class="btn_set">
                                                <span>YES</span>
                                                <span>NO</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>감독 나이</strong>
                                            <span>감독이 60세 이상인 경우</span>
                                        </div>
                                        <div class="confirm">
                                            <div class="btn_set">
                                                <span>YES</span>
                                                <span>NO</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>크랭크업 시기</strong>
                                            <span>크랭크업 후 1년 이상의 기간이 경과한 경우</span>
                                        </div>
                                        <div class="confirm">
                                            <div class="btn_set">
                                                <span>YES</span>
                                                <span>NO</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>연속 흥행 여부</strong>
                                            <span>배우‧감독이 연속 3편 이상 흥행한 경우</span>
                                        </div>
                                        <div class="confirm">
                                            <div class="btn_set">
                                                <span>YES</span>
                                                <span>NO</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>특정 영화관 단독 개봉 여부</strong>
                                            <span>특정 영화관에서 단독 개봉하는 경우</span>
                                        </div>
                                        <div class="confirm">
                                            <div class="btn_set">
                                                <span>YES</span>
                                                <span>NO</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li>
                                    <div class="item">
                                        <div class="tit">
                                            <strong>특수관계 여부</strong>
                                            <span>배우‧감독‧제작사가 혈연‧학연 등 특수관계가 있는 경우</span>
                                        </div>
                                        <div class="confirm">
                                            <div class="btn_set">
                                                <span>YES</span>
                                                <span>NO</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div class="final_confirm">
                            <div class="final_gp">
                                <div class="final_label">최종평가</div>
                                <div class="final_bar">
                                    <div class="final_cursor">
                                        <div class="cursor_knob"></div>
                                        <div class="cursor_line"></div>
                                        <div class="cursor_text p01">비적합</div>
                                        <div class="cursor_text p02">기준 충족</div>
                                        <div class="cursor_text p03">적합</div>
                                        <div class="cursor_text p04">매우 적합</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="movie_closed">
                <div class="txt">
                    <video src="../../resources/images/gate_02/close.mp4" autoplay muted loop playsinline></video>
                    <strong>영화 상영 기간 종료</strong>
                    <p>
                        <span class="ing_01">누적 관관객 수 집계 중...</span>
                        <span class="ing_02">누적 매출액 집계 중...</span>
                    </p>
                </div>
            </div>

            <div class="inve_result">
                <div class="inner">
                    <div class="inve_mv_bg">
                        <span class="bg"></span>
                        <span class="logo">
                            <img src="../../resources/images/gate_02/k_con_list_04_logo.png">
                        </span>
                    </div>
                    <div class="desc">
                        <strong>투자 결과</strong>
                        <p>
                            관객 수 및 매출액 집계가 완료되었습니다.<br>
                            지금 투자 수익률을 확인하세요.
                        </p>
                    </div>
                    <div class="inve_info_list">
                        <div class="step_01">
                            <div class="step_01_item">
                                <div class="ico_01">
                                    <span>누적 관객 수</span>
                                </div>
                                <div class="num_box">
                                    <span class="num data_01">12,275,843</span>
                                    <span>명</span>
                                </div>
                            </div>
                            <div class="step_01_item">
                                <div class="ico_02">
                                    <span>누적 매출액</span>
                                </div>
                                <div class="num_box">
                                    <span class="num data_02">102,404,077,109</span>
                                    <span>원</span>
                                </div>
                            </div>
                        </div>
                        <div class="step_02">
                            <div class="sm_num">
                                <span class="ico_01">누적 관객 수</span>
                                <span class="box"><span class="num data_01">12,275,843</span>명</span>
                            </div>
                            <div class="sm_num">
                                <span class="ico_02">누적 매출액</span>
                                <span class="box"><span class="num data_02">102,404,077,109</span>원</span>
                            </div>
                        </div>
                        <div class="step_03">
                            <div class="box_item">
                                <span class="tit">투자원금</span>
                                <span class="data">
                                    <span class="data_03">500,000,000</span>원
                                </span>
                            </div>
                        </div>
                        <div class="step_04">
                            <div class="box_item">
                                <span class="tit">수익(수익률)</span>
                                <span class="per">▲<span class="data_04">125</span>%</span>
                                <span class="data">
                                    <span class="data_05">500,000,000</span>원
                                </span>
                            </div>
                        </div>
                        <div class="step_05">
                            <span>*해당 수익률은 실제 작품의 투자 수익률과 다를 수 있습니다.</span>
                        </div>
                        <div class="step_06">
                            <div class="chc_mv_btn">
                                <a href="../gate02/gate_02.html"><span>다른 영화 투자 하기</span></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="inve_pop pop_01">
                <div class="inner">
                    <div class="info">
                        <strong class="tit">투자 적격 여부</strong>
                        <div class="result">
                            <span>적합</span>
                        </div>
                        <div class="sub">
                            <span>해당 영화는 투자 검토 대상에 적합합니다.</span>
                        </div>
                        <div class="q">
                            <span>해당 영화의 최종 투자 여부 과정을 확인해보시겠습니까?</span>
                        </div>
                    </div>
                    <div class="btn">
                        <button type="button" class="btn_next">
                            <span>투자 여부 검토</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="inve_pop pop_02">
                <div class="inner">
                    <div class="info">
                        <strong class="tit">투자여부</strong>
                        <div class="result">
                            <span>기준 충족</span>
                        </div>
                        <div class="sub">
                            <span>해당 영화는 IBK의 투자 기준을 충족하였습니다.</span>
                        </div>
                        <div class="q">
                            <span>해당 영화의 최종 투자 여부 결과를 확인하시겠습니까?</span>
                        </div>
                    </div>
                    <div class="btn">
                        <button type="button" class="btn_next">
                            <span>최종 투자 여부 결과</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- //Container -->

    <!-- Footer -->
    <footer>
    </footer>
    <!-- //Footer -->
</div>
<!-- //wrap -->




<script>
    // gate_02_04.html 에 넣어줄 스크립트
document.addEventListener('DOMContentLoaded', function () {
    console.log('▶ gate_02_04 페이지 진입');

    // 1) sessionStorage 에서 값 꺼내기
    var rawVisitor = sessionStorage.getItem('kcon_visitor'); // 1000000 / 5000000 / 10000000
    var rawAmount  = sessionStorage.getItem('kcon_amount');  // 1 / 5 / 10

    console.log('sessionStorage.kcon_visitor:', rawVisitor);
    console.log('sessionStorage.kcon_amount :', rawAmount);

    // 2) 값이 없을 때 대비
    if (rawVisitor === null || rawAmount === null) {
        console.warn('⚠ kcon_visitor / kcon_amount 값이 없습니다. 이전 페이지에서 세팅됐는지 확인 필요');
        return;
    }

    // 3) 숫자로 변환
    var visitor = Number(rawVisitor);
    var amount  = Number(rawAmount);

    if (Number.isNaN(visitor) || Number.isNaN(amount)) {
        console.warn('⚠ 숫자 변환 실패 visitor:', rawVisitor, 'amount:', rawAmount);
        return;
    }

    // 4) 최종 값 콘솔 확인
    console.log('✅ 전달받은 예상 관람객(명):', visitor);      // ex) 1000000
    console.log('✅ 전달받은 투자금액(억):', amount);         // ex) 5

    // 5) 보기 좋게 가공한 버전도 한 번 출력 (옵션)
    var visitorDisplayMan = visitor / 10000; // 1000000 → 100만
    console.log('   → 표시용: 예상 관람객', visitorDisplayMan + '만 명');
    console.log('   → 표시용: 투자금액', amount + '억');

    // 여기서부터는 실제 계산/화면 출력 등에 사용하면 됨
    // 예) document.querySelector('.some_selector').textContent = visitorDisplayMan + '만 명';
});
</script>
</body>
</html>
















<script>
  /* Gate02 sub */
  document.addEventListener('DOMContentLoaded', function () {
    // 공통 SVG 경로
    var SVG_PATH = '../../resources/images/chk_ico_prog.svg';

    // 대상 item들
    var items = Array.prototype.slice.call(
        document.querySelectorAll('.gate_02.sub [class*="gate_02"] .inve_confirm_list .item')
    );
    if (!items.length) return;

    // 1초 뒤에 시작
    var baseDelay = 1000;

    // item들을 랜덤 순서로 섞기
    var shuffledItems = items.slice().sort(function () {
        return Math.random() - 0.5;
    });

    shuffledItems.forEach(function (item, index) {
        var confirmBox = item.querySelector('.confirm');
        if (!confirmBox) return;

        // 각 아이템 사이 간격 1~1.5초 랜덤
        var interval = 1000 + Math.random() * 500; // 1000~1500ms
        var startTime = baseDelay + index * interval;

        setTimeout(function () {

            // 1) 체크 아이콘 "새 인스턴스"로 생성 + 삽입
            //    → 쿼리스트링을 붙여서 매번 다른 URL처럼 보이게 해서
            //      SVG 애니메이션이 각각 개별로 재생되도록 함
            var ico = document.createElement('img');
            ico.className = 'ico';
            ico.src = SVG_PATH + '?t=' + Date.now() + '_' + Math.random(); 
            // 위 ?t=... 부분이 포인트

            confirmBox.appendChild(ico);

            // 먼저 display 보이게 하고
            ico.style.display = 'inline-block';

            // 다음 프레임에 opacity transition 적용
            requestAnimationFrame(function () {
                ico.classList.add('active'); // opacity 1
            });

            // 3초 후 아이콘 서서히 사라짐
            setTimeout(function () {
                ico.classList.remove('active');  // opacity 0으로

                // 아이콘이 사라지는 transition 시간(0.6초) 이후에 버튼 등장
                setTimeout(function () {
                    ico.style.display = 'none';

                    // 2) 버튼 생성/표시
                    var btn = confirmBox.querySelector('button.btn.case_01');
                    if (!btn) {
                        btn = document.createElement('button');
                        btn.type = 'button';
                        btn.className = 'btn case_01';
                        btn.textContent = '적합';
                        confirmBox.appendChild(btn);
                    }

                    btn.style.display = 'inline-flex';
                    requestAnimationFrame(function () {
                        btn.classList.add('active'); // opacity 1
                    });

                }, 200); // CSS transition 0.6s와 맞춤

            }, 1500); // 아이콘이 1.5초 동안 화면에 있다가 사라짐

        }, startTime); // 2초 후 + (1~1.5초 * index) 마다 순차 실행
    });
});


document.addEventListener('DOMContentLoaded', function () {
    var bgList = document.querySelectorAll('.kcon_bg');

    bgList.forEach(function (bg) {
        var video  = bg.querySelector('.video-el');
        var poster = bg.querySelector('.video-poster');
        if (!video) return;

        var posterTimer = null;

        // 포스터 → 영상 전환 + 재생
        function showVideo() {
            if (bg.classList.contains('is-ready')) return;

            bg.classList.add('is-ready'); // CSS에서 포스터/영상 전환

            var p = video.play();
            if (p && typeof p.catch === 'function') {
                p.catch(function () {
                    // 자동재생 막혔을 때 처리하고 싶으면 여기서
                });
            }
        }

        // 이 bg를 "처음부터 다시" 시작하는 함수
        function restartWithPosterDelay() {
            // 다른 타이머 있으면 정리
            if (posterTimer) {
                clearTimeout(posterTimer);
                posterTimer = null;
            }

            // 상태 리셋
            bg.classList.remove('is-ready');
            video.pause();
            video.currentTime = 0;

            // 이벤트 핸들러
            function onCanPlay() {
                video.removeEventListener('canplaythrough', onCanPlay);
                video.removeEventListener('canplay', onCanPlay);

                // 준비된 시점 기준으로 1초 후 포스터 → 영상 전환
                posterTimer = setTimeout(showVideo, 1000);
            }

            // 혹시 중복 등록되지 않도록 한 번 정리 후 다시 등록
            video.removeEventListener('canplaythrough', onCanPlay);
            video.removeEventListener('canplay', onCanPlay);
            video.addEventListener('canplaythrough', onCanPlay);
            video.addEventListener('canplay', onCanPlay);

            // 이미 어느 정도 로드된 상태면 바로 2초 타이머
            if (video.readyState >= 3) { // HAVE_FUTURE_DATA 이상
                posterTimer = setTimeout(showVideo, 2000);
            } else {
                video.load();
            }
        }

        // 이 bg에 재시작 함수를 저장 (jQuery 쪽에서 호출용)
        bg._restartKconVideo = restartWithPosterDelay;

        // 처음부터 on인 bg가 있다면 자동 시작하고 싶으면 이 부분 사용
        var wrap = bg.closest('.kcon_bg_wrap');
        if (wrap && wrap.classList.contains('on')) {
            restartWithPosterDelay();
        }
    });
});



$(document).on('click', '.pop_btn', function () {
  window.location.href = './html/gate02/gate_02_01.html';
});


document.addEventListener('DOMContentLoaded', function () {
    // --------------------------------------------------------------------
    // 공통 엘리먼트
    // --------------------------------------------------------------------
    var confirmBoxWrap  = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_confirm_box');
    var examineBoxWrap  = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_examine_box');
    var confirmWrap     = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_confirm_wrap');
    var movieClosed     = document.querySelector('.gate_02.sub [class*="gate_02"] .movie_closed');
    var inveResult      = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_result');

    // 추가: inve_adj_box
    var adjBoxWrap      = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_adj_box');

    // 커서: confirm / examine / adj 각각 별도
    var confirmCursor   = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_confirm_box .final_cursor');
    var examineCursor   = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_examine_box .final_cursor');
    var adjCursor       = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_adj_box .final_cursor');

    // 커서 텍스트 (공통)
    var cursorText      = document.querySelector('.final_gp .cursor_text');

    // 팝업
    var pop01           = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_pop.pop_01');
    var pop02           = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_pop.pop_02');

    if (!confirmCursor && !examineCursor && !adjCursor) return;

    // --------------------------------------------------------------------
    // 숫자 유틸 & 카운트 함수
    // --------------------------------------------------------------------
    function parseNumber(str){
        const num = parseInt(str.replace(/[^\d\-]/g,''),10);
        return isNaN(num)?0:num;
    }
    function formatNumber(num){
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");
    }
    function countUp($el,from,to,duration,formatter,onComplete){
        const startTime = Date.now();
        const diff = to-from;
        function tick(){
            const now = Date.now();
            const elapsed = now-startTime;
            const progress = Math.min(elapsed/duration,1);
            const value = Math.round(from+diff*progress);
            $el.text(formatter?formatter(value):value);
            if(progress<1){
                requestAnimationFrame(tick);
            }else if(typeof onComplete==="function"){
                onComplete();
            }
        }
        requestAnimationFrame(tick);
    }

    // --------------------------------------------------------------------
    // 결과 숫자/스텝 애니 시작 함수
    // --------------------------------------------------------------------
    function startInveInfoAnimation(){
        const $wrap = $('.gate_02.sub [class*="gate_02"] .inve_info_list');
        if(!$wrap.length) return;

        const $step01=$wrap.find('.step_01');
        const $step02=$wrap.find('.step_02');
        const $step03=$wrap.find('.step_03');
        const $step04=$wrap.find('.step_04');
        const $step05=$wrap.find('.step_05');
        const $step06=$wrap.find('.step_06');

        const $s1_d1=$step01.find('.data_01');
        const $s1_d2=$step01.find('.data_02');
        const $s3_d3=$step03.find('.data_03');
        const $s4_d5=$step04.find('.data_05');
        const $s4_d4=$step04.find('.data_04');

        const s1_d1_target=parseNumber($s1_d1.text());
        const s1_d2_target=parseNumber($s1_d2.text());
        const s3_d3_target=parseNumber($s3_d3.text());
        const s4_d5_target=parseNumber($s4_d5.text());

        const d4_raw=$s4_d4.text().trim();
        const d4_prefix=(d4_raw.match(/^[^\d\-]*/)||[''])[0];
        const d4_suffix=(d4_raw.match(/[^\d]*$/)||[''])[0];
        const d4_num=parseNumber(d4_raw);

        $s1_d1.text('0');
        $s1_d2.text('0');
        $s3_d3.text('0');
        $s4_d5.text('0');
        $s4_d4.text(d4_prefix+'0'+d4_suffix);

        const $steps=$wrap.children('div');
        $steps.addClass('step-hidden').removeClass('step-visible step-hide-up');
        $step01.removeClass('step-hidden').addClass('step-visible');

        const DURATION_S1_NUM=2000;
        const DURATION_S3_NUM=2000;
        const DURATION_S4_D5=2000;
        const DURATION_S4_D4=2000;
        const DELAY_BETWEEN=500;
        const DELAY_AFTER_S3=500;
        const DELAY_AFTER_S1=1000;

        setTimeout(startStep1,500);

        function startStep1(){
            let doneCount=0;
            function done(){
                doneCount++;
                if(doneCount===2){
                    setTimeout(nextFromStep1,DELAY_AFTER_S1);
                }
            }
            countUp($s1_d1,0,s1_d1_target,DURATION_S1_NUM,formatNumber,done);
            countUp($s1_d2,0,s1_d2_target,DURATION_S1_NUM,formatNumber,done);
        }

        function nextFromStep1(){
            $step01.removeClass('step-visible step-hidden').addClass('step-hide-up');
            $step02.removeClass('step-hidden step-hide-up').addClass('step-visible');
            setTimeout(startStep3,DELAY_BETWEEN);
        }

        function startStep3(){
            $step03.removeClass('step-hidden step-hide-up').addClass('step-visible');
            countUp($s3_d3,0,s3_d3_target,DURATION_S3_NUM,formatNumber,function(){
                setTimeout(startStep4,DELAY_AFTER_S3);
            });
        }

        function startStep4(){
            $step04.removeClass('step-hidden step-hide-up').addClass('step-visible');
            $step05.removeClass('step-hidden step-hide-up').addClass('step-visible');

            setTimeout(function(){
                countUp($s4_d5,0,s4_d5_target,DURATION_S4_D5,formatNumber,function(){
                    setTimeout(function(){
                        countUp($s4_d4,0,d4_num,DURATION_S4_D4,function(val){
                            return d4_prefix+val+d4_suffix;
                        },function(){
                            setTimeout(showStep6,DELAY_BETWEEN);
                        });
                    },DELAY_BETWEEN);
                });
            },DELAY_BETWEEN);
        }

        function showStep6(){
            $step06.removeClass('step-hidden step-hide-up').addClass('step-visible');
        }
    }

    // --------------------------------------------------------------------
    // 커서 이동 헬퍼 (confirm / examine / adj)
    // --------------------------------------------------------------------
    function clampPercent(p){
        return Math.max(0, Math.min(100, p));
    }

    function moveConfirmCursor(percent){
        if (!confirmCursor) return;
        confirmCursor.style.left = clampPercent(percent) + '%';
    }

    function moveExamineCursor(percent){
        if (!examineCursor) return;
        examineCursor.style.left = clampPercent(percent) + '%';
    }

    function moveAdjCursor(percent){
        if (!adjCursor) return;
        adjCursor.style.left = clampPercent(percent) + '%';
    }

    // 외부에서 같이 움직일 수 있게
    window.moveFinalCursor = function(percent){
        moveConfirmCursor(percent);
        moveExamineCursor(percent);
        moveAdjCursor(percent);
    };

    // 초기 상태
    if (examineBoxWrap) { examineBoxWrap.style.display = 'none'; }
    if (adjBoxWrap)     { adjBoxWrap.style.display     = 'none'; }
    if (confirmCursor)  { confirmCursor.style.left = '0.4vw'; }
    if (examineCursor)  { examineCursor.style.left = '0.4vw'; }
    if (adjCursor)      { adjCursor.style.left     = '0.4vw'; }

    // --------------------------------------------------------------------
    // Chart.js 레이더 차트: 그리드만 먼저, 마지막 단계에서 폴리곤
    // --------------------------------------------------------------------
    var movieRadar = null;

    function initMovieRadarBase(){
        if (movieRadar) return;

        var canvas = document.getElementById('movieRadar');
        if (!canvas) return;

        var ctx = canvas.getContext('2d');

        movieRadar = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['시나리오', '감독', '배우', '제작사 역량', '배급', '투자'],
                datasets: [{
                    label: '평가',
                    data: [0, 0, 0, 0, 0, 0],
                    borderColor: 'rgba(0,0,0,0)',
                    backgroundColor: 'rgba(0,0,0,0)',
                    borderWidth: 0,
                    pointBackgroundColor: 'rgba(0,0,0,0)',
                    pointBorderColor: 'rgba(0,0,0,0)',
                    pointRadius: 0,
                    pointHoverRadius: 0,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: false,
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: false }
                },
                layout: { padding: 10 },
                scales: {
                    r: {
                        min: 0,
                        max: 100,
                        ticks: {
                            display: false,
                            stepSize: 20
                        },
                        grid: {
                            color: 'rgba(241, 241, 241, 1)'
                        },
                        angleLines: {
                            color: 'rgba(241, 241, 241, 1)'
                        },
                        pointLabels: {
                            color: '#ffffff',
                            font: {
                                size: 25,
                                family: 'Pretendard, Noto Sans KR, sans-serif'
                            }
                        }
                    }
                }
            }
        });
    }

    function animateMovieRadar(){
        if (!movieRadar) return;

        var ds = movieRadar.data.datasets[0];

        ds.data = [81, 50, 60, 60, 55, 60];

        ds.borderColor = '#1d7bff';
        ds.backgroundColor = 'rgba(29, 123, 255, 0.35)';
        ds.borderWidth = 4;
        ds.pointBackgroundColor = '#1d7bff';
        ds.pointBorderColor = '#1d7bff';
        ds.pointRadius = 8;
        ds.pointHoverRadius = 8;

        movieRadar.options.animation = {
            duration: 800,
            easing: 'easeOutQuad'
        };

        movieRadar.update();
    }

    // DOM 로드 시점에 그리드만 보이는 차트 준비
    initMovieRadarBase();

    // --------------------------------------------------------------------
    // adj_box 끝난 후 confirm_wrap → movie_closed → inve_result
    // --------------------------------------------------------------------
    function runConfirmWrapSequence() {
        if (!confirmWrap) {
            if (inveResult) {
                inveResult.classList.add('fade-in-up');
                var resultHandler2 = function (rv2) {
                    if (rv2.propertyName !== 'opacity') return;
                    inveResult.removeEventListener('transitionend', resultHandler2);
                    startInveInfoAnimation();
                };
                inveResult.addEventListener('transitionend', resultHandler2);
            } else {
                startInveInfoAnimation();
            }
            return;
        }

        // adj 애니 끝난 시점에서 2초 유지
        setTimeout(function () {
            confirmWrap.classList.add('fade-out-up');

            var handler = function (e) {
                if (e.propertyName !== 'opacity') return;
                confirmWrap.removeEventListener('transitionend', handler);

                setTimeout(function () {
                    confirmWrap.style.display = 'none';

                    // movie_closed → inve_result
                    if (movieClosed) {
                        movieClosed.style.display = 'flex';
                        movieClosed.classList.remove('fade-out-up');
                        movieClosed.classList.add('fade-in-up');

                        setTimeout(function () {
                            movieClosed.classList.remove('fade-in-up');
                            movieClosed.classList.add('fade-out-up');

                            var closedHandler = function (ev) {
                                if (ev.propertyName !== 'opacity') return;
                                movieClosed.removeEventListener('transitionend', closedHandler);

                                movieClosed.style.display = 'none';

                                if (inveResult) {
                                    inveResult.classList.add('fade-in-up');

                                    var resultHandler = function (rv) {
                                        if (rv.propertyName !== 'opacity') return;
                                        inveResult.removeEventListener('transitionend', resultHandler);
                                        startInveInfoAnimation();
                                    };
                                    inveResult.addEventListener('transitionend', resultHandler);
                                } else {
                                    startInveInfoAnimation();
                                }
                            };

                            movieClosed.addEventListener('transitionend', closedHandler);
                        }, 2100);
                    } else {
                        if (inveResult) {
                            inveResult.classList.add('fade-in-up');
                            var resultHandler2 = function (rv2) {
                                if (rv2.propertyName !== 'opacity') return;
                                inveResult.removeEventListener('transitionend', resultHandler2);
                                startInveInfoAnimation();
                            };
                            inveResult.addEventListener('transitionend', resultHandler2);
                        } else {
                            startInveInfoAnimation();
                        }
                    }
                }, 500);
            };

            confirmWrap.addEventListener('transitionend', handler);

        }, 500);
    }

    // --------------------------------------------------------------------
    // examine_box → fade-out-up 넣으면서 동시에 adj_box fade-in-up
    //  + adj_box display:block 은 fade-in-up 넣고 0.3초 뒤에 적용
    // --------------------------------------------------------------------
    function endExamineAndStartAdj(){
        if (!examineBoxWrap) {
            // examine 박스가 없으면 바로 adj 시퀀스
            runAdjBoxSequence();
            return;
        }

        // 1) examine_box 위로 사라지는 애니
        examineBoxWrap.classList.remove('fade-in-up');
        examineBoxWrap.classList.add('fade-out-up');

        // 2) adj_box에 fade-in-up을 동시에 넣고
        if (adjBoxWrap) {
            adjBoxWrap.classList.remove('fade-out-up');
            adjBoxWrap.classList.add('fade-in-up');
        }

        // 3) adj_box 내부 시퀀스 시작
        runAdjBoxSequence();

        // 4) examine_box는 애니 조금 여유 두고 display:none
        setTimeout(function(){
            examineBoxWrap.style.display = 'none';
        }, 700); // 전환 여유
    }

    // --------------------------------------------------------------------
    // inve_adj_box 시퀀스
    //  - fade-in-up 먼저 넣고 0.3초 뒤 display:block
    //  - 버튼 span.on 진행 + 자동 스크롤
    //  - final_cursor 7초 타임라인 + p01~p04 전환
    // --------------------------------------------------------------------
    function runAdjBoxSequence(){
        if (!adjBoxWrap) {
            // adj_box 없으면 바로 confirm_wrap 시퀀스
            runConfirmWrapSequence();
            return;
        }

        var ADJ_DISPLAY_DELAY = 500; // fade-in-up 넣은 뒤 0.3초 후 display:block

        // fade-in-up 클래스 세팅
        adjBoxWrap.classList.remove('fade-out-up');
        adjBoxWrap.classList.add('fade-in-up');

        setTimeout(function () {
            adjBoxWrap.style.display = 'block';

            // 내부 애니는 살짝 뒤에 시작
            setTimeout(function(){
                var btnSets = adjBoxWrap.querySelectorAll('.inve_adj_list .btn_set');
                var maxIdx  = btnSets.length;

                if (!maxIdx) {
                    runConfirmWrapSequence();
                    return;
                }

                // 스크롤 컨테이너
                var adjList = document.querySelector('.gate_02.sub [class*="gate_02"] .inve_adj_list');

                // adj_box 안 p01~p04 수집
                var adjTexts = [];
                for (var i = 1; i <= 4; i++) {
                    var t = adjBoxWrap.querySelector('.p0' + i);
                    if (t) adjTexts.push(t);
                }

                // p01~p04 초기 세팅 (p01만 보이게)
                if (adjTexts.length) {
                    adjTexts.forEach(function(el, idx){
                        el.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
                        if (idx === 0) {
                            el.style.display   = 'block';
                            el.style.opacity   = 1;
                            el.style.transform = 'translateY(0)';
                        } else {
                            el.style.display   = 'none';
                            el.style.opacity   = 0;
                            el.style.transform = 'translateY(10px)';
                        }
                    });
                }

                // p01~p04 전환 함수
                function showAdjText(targetIdx) {
                    if (!adjTexts.length || !adjTexts[targetIdx]) return;

                    adjTexts.forEach(function(el, idx){
                        if (idx === targetIdx) return;
                        if (el.style.display !== 'none') {
                            el.style.opacity   = 0;
                            el.style.transform = 'translateY(-10px)';
                            (function(node){
                                setTimeout(function(){
                                    node.style.display = 'none';
                                }, 400); // 트랜지션 0.4s 끝난 뒤 display:none
                            })(el);
                        }
                    });

                    var showTarget = adjTexts[targetIdx];

                    // ★ 여기 딜레이를 1000 → 420 정도로 변경
                    setTimeout(function(){
                        showTarget.style.display   = 'block';
                        showTarget.getBoundingClientRect();
                        showTarget.style.opacity   = 1;
                        showTarget.style.transform = 'translateY(0)';
                    }, 420); // 0.4s 트랜지션랑 거의 맞춰줌
                }

                var targetMap = [1, 1, 1, 0, 1, 1, 1];

                // 버튼 span.on 애니 (1초 간격) + 자동 스크롤
                for (let i = 0; i < maxIdx && i < targetMap.length; i++) {
                    (function(index){
                        setTimeout(function(){
                            var btn   = btnSets[index];
                            var spans = btn.querySelectorAll('span');
                            if (!spans.length) return;

                            spans.forEach(function(s){ s.classList.remove('on'); });

                            var tIdx = targetMap[index];
                            if (spans[tIdx]) {
                                spans[tIdx].classList.add('on');

                                // 자동 스크롤
                                if (adjList) {
                                    var li = btn.closest('li');
                                    if (li) {
                                        var listRect = adjList.getBoundingClientRect();
                                        var liRect   = li.getBoundingClientRect();

                                        if (liRect.bottom > listRect.bottom) {
                                            var delta = liRect.bottom - listRect.bottom;
                                            var newScrollTop = adjList.scrollTop + delta + 25;

                                            adjList.scrollTo({
                                                top: newScrollTop,
                                                behavior: 'smooth'
                                            });
                                        }
                                    }
                                }
                            }
                        }, index * 1000);
                    })(i);
                }

                // 커서 + 텍스트 + p01~p04 전환 (총 7초 시나리오)
                var labels          = ['비적합','기준충족','적합','매우적합'];
                var cursorPositions = [0, 30, 60, 85]; // moveAdjCursor는 % 기준

                var CURSOR_TOTAL = 7000; // 7초

                // 0~4초: left 0.4vw, 비적합 + p01
                if (adjCursor)    adjCursor.style.left = '0.4vw';
                if (cursorText)   cursorText.textContent = labels[0];
                if (adjTexts.length) showAdjText(0);

                // 5초: 기준충족 + p02, 첫 번째 이동
                setTimeout(function(){
                    moveAdjCursor(cursorPositions[1]);   // 30% 쪽으로 이동
                    if (cursorText) cursorText.textContent = labels[1];
                    if (adjTexts.length) showAdjText(1);
                }, 4000);

                // 6초: 적합 + p03, 두 번째 이동
                setTimeout(function(){
                    moveAdjCursor(cursorPositions[2]);   // 60%
                    if (cursorText) cursorText.textContent = labels[2];
                    if (adjTexts.length) showAdjText(2);
                }, 5000);

                // 7초: 매우적합 + p04, 세 번째 이동
                setTimeout(function(){
                    moveAdjCursor(cursorPositions[3]);   // 85%
                    if (cursorText) cursorText.textContent = labels[3];
                    if (adjTexts.length) showAdjText(3);
                }, 6000);

                // 버튼 애니 전체 시간
                var totalBtnDuration = (Math.min(maxIdx, targetMap.length) - 1) * 1000;
                if (totalBtnDuration < 0) totalBtnDuration = 0;

                // 커서/텍스트 7초 연출이 끝난 뒤 + 버튼 애니 둘 다 끝난 다음 → pop_02
                var endDelay = Math.max(totalBtnDuration, CURSOR_TOTAL) + 500;
                setTimeout(function(){
                    showPop02();
                }, endDelay);

            }, 400); // fade-in-up 끝난 느낌으로 내부 애니 시작

        }, ADJ_DISPLAY_DELAY);
    }

    // --------------------------------------------------------------------
    // inve_examine_box 시퀀스 (팝업 01에서 시작)
    // --------------------------------------------------------------------
    function startExamineSequence() {
        // confirmBoxWrap 사라지기
        if (confirmBoxWrap) {
            confirmBoxWrap.classList.add('fade-out-up');
            setTimeout(function () {
                confirmBoxWrap.style.display = 'none';
            }, 600);
        }

        // examine 박스가 없으면 바로 adj로
        if (!examineBoxWrap) {
            endExamineAndStartAdj();
            return;
        }

        // 2) inve_examine_box 등장
        examineBoxWrap.style.display = 'block';
        examineBoxWrap.getBoundingClientRect();
        examineBoxWrap.classList.add('fade-in-up');

        // p01~p04 텍스트 초기 세팅 (p01만 노출)
        var examineTexts = [];
        for (var i = 1; i <= 4; i++) {
            var t = examineBoxWrap.querySelector('.p0' + i);
            if (t) examineTexts.push(t);
        }

        examineTexts.forEach(function (el, idx) {
            el.style.transition = 'opacity 0.4s ease, transform 0.4s ease';
            if (idx === 0) {
                el.style.display = 'block';
                el.style.opacity = 1;
                el.style.transform = 'translateY(0)';
            } else {
                el.style.display = 'none';
                el.style.opacity = 0;
                el.style.transform = 'translateY(10px)';
            }
        });

        // p01~p04 전환 (총 6단계)
        function showProgressText(stepIndex) {
            if (!examineTexts.length) return;

            var targetIdx;
            if (stepIndex <= 2)          targetIdx = 0;
            else if (stepIndex === 3)    targetIdx = 1;
            else if (stepIndex === 4)    targetIdx = 2;
            else                         targetIdx = 3;

            examineTexts.forEach(function (el, idx) {
                if (idx === targetIdx) return;
                if (el.style.display !== 'none') {
                    el.style.opacity = 0;
                    el.style.transform = 'translateY(-10px)';
                    (function (node) {
                        setTimeout(function () {
                            node.style.display = 'none';
                        }, 400);
                    })(el);
                }
            });

            var showTarget = examineTexts[targetIdx];
            if (!showTarget) return;

            setTimeout(function () {
                showTarget.style.display = 'block';
                showTarget.getBoundingClientRect();
                showTarget.style.opacity = 1;
                showTarget.style.transform = 'translateY(0)';
            }, 420);
        }

        // examineBox 올라온 뒤 1초 후 단계 시퀀스 시작
        setTimeout(function () {

            var STEP_DURATION = 1500;

            var steps = document.querySelectorAll('.step_examine_list [class^="step_examine_"]');
            var examineGroups = document.querySelectorAll('[class^="inve_examine_step_"]');

            if (!steps.length || !examineGroups.length) {
                // 예외: 단계 구조가 없으면 바로 examine 닫고 adj로
                endExamineAndStartAdj();
                return;
            }

            var totalSteps  = steps.length; // 기대: 6
            var examineMax  = 85;          // 0 → 85%

            // 모든 단계 컨텐츠 초기화
            examineGroups.forEach(function (grp) {
                grp.style.display = 'none';
                grp.classList.remove('fade-in-up', 'fade-out-up');

                var gauges = grp.querySelectorAll('.inve_examine_gp_item .bar .gauge');
                gauges.forEach(function (g) {
                    g.style.transition = 'none';
                    g.style.width = '0%';
                });
            });

            // 게이지 애니
            function animateGauges(group) {
                var bars = group.querySelectorAll('.inve_examine_gp_item .bar');
                var barCount = bars.length;
                if (!barCount) return;

                var perTime = STEP_DURATION / barCount;

                bars.forEach(function (bar, idx) {
                    var gauge = bar.querySelector('.gauge');
                    if (!gauge) return;

                    var target = parseFloat(gauge.getAttribute('data-percent')) || 100;

                    gauge.style.transition = 'none';
                    gauge.style.width = '0%';
                    gauge.getBoundingClientRect();

                    setTimeout(function () {
                        gauge.style.transition = 'width ' + (perTime / 1000) + 's ease';
                        gauge.style.width = target + '%';
                    }, idx * perTime);
                });
            }

            // 단계별 실행 (총 6단계, 0~5 index)
            function showStep(stepIndex) {
                var lastIndex = totalSteps - 1;

                if (stepIndex > lastIndex || stepIndex >= examineGroups.length) {
                    // 모든 단계 끝 → examine 박스 닫고 adj 시작
                    endExamineAndStartAdj();
                    return;
                }

                // 동그라미 상태 처리
                steps.forEach(function (el, i) {
                    el.classList.remove('done');

                    if (stepIndex === lastIndex) {
                        if (i < lastIndex) {
                            el.classList.remove('on');
                            el.classList.add('done');
                        } else if (i === lastIndex) {
                            el.classList.add('on');
                        }
                    } else {
                        if (i <= stepIndex) {
                            el.classList.add('on');
                        } else {
                            el.classList.remove('on');
                        }
                    }
                });

                // examine 커서: 0 → 85% (0~5)
                var cursorTarget = (stepIndex / lastIndex) * examineMax;
                moveExamineCursor(cursorTarget);

                // p01~p04 텍스트 전환
                showProgressText(stepIndex);

                var currentGroup = examineGroups[stepIndex];

                currentGroup.style.display = 'flex';
                currentGroup.classList.remove('fade-out-up');
                currentGroup.classList.add('fade-in-up');

                // 게이지 애니
                animateGauges(currentGroup);

                if (stepIndex === lastIndex) {
                    // 마지막 단계: 레이더 차트 그리고
                    animateMovieRadar();

                    // 마지막 그룹 애니 끝난 뒤 examine_box 자체 fade-out-up → adj
                    setTimeout(function () {
                        endExamineAndStartAdj();
                    }, STEP_DURATION);
                } else {
                    setTimeout(function () {
                        currentGroup.classList.remove('fade-in-up');
                        currentGroup.classList.add('fade-out-up');

                        var hideHandler = function (ev) {
                            if (ev.propertyName !== 'opacity') return;
                            currentGroup.removeEventListener('transitionend', hideHandler);

                            currentGroup.style.display = 'none';
                            showStep(stepIndex + 1);
                        };

                        currentGroup.addEventListener('transitionend', hideHandler);
                    }, STEP_DURATION);
                }
            }

            // 첫 단계 시작
            showStep(0);

        }, 1000); // examineBoxWrap 올라온 후 대기
    }

    // --------------------------------------------------------------------
    // pop_01 / pop_02 제어
    // --------------------------------------------------------------------
    function showPop01() {
        if (!pop01) {
            // 팝업이 없으면 기존처럼 바로 진행
            startExamineSequence();
            return;
        }
        pop01.classList.add('is-active');
    }

    function showPop02() {
        if (!pop02) {
            // 팝업이 없으면 바로 기존 시퀀스
            runConfirmWrapSequence();
            return;
        }
        pop02.classList.add('is-active');
    }

    // 팝업 버튼 이벤트: pop_01 → examine, pop_02 → movie_closed + inve_result
    if (pop01) {
        var pop01Btn = pop01.querySelector('.btn_next');
        if (pop01Btn) {
            pop01Btn.addEventListener('click', function () {
                pop01.classList.remove('is-active');
                startExamineSequence();
            });
        }
    }

    if (pop02) {
        var pop02Btn = pop02.querySelector('.btn_next');
        if (pop02Btn) {
            pop02Btn.addEventListener('click', function () {
                pop02.classList.remove('is-active');
                runConfirmWrapSequence();
            });
        }
    }

    // --------------------------------------------------------------------
    // 커서 & confirm/examine 시퀀스 시작
    //   - inve_confirm_box 커서 애니 끝 → pop_01 노출
    // --------------------------------------------------------------------
    setTimeout(function () {
        if (cursorText) {
            setTimeout(function () { cursorText.style.opacity = 1; }, 1300);
        }

        // 1) inve_confirm_box 구간 커서 (0 → 85%)
        var step        = 0;
        var maxStep     = 4;
        var maxPercent  = 85;

        var intervalId = setInterval(function () {
            step++;

            if (step <= maxStep) {
                var percent = (step / maxStep) * maxPercent;
                moveConfirmCursor(percent);
            }

            if (step === maxStep) {
                clearInterval(intervalId);

                // 커서 애니 끝난 후 1초 뒤 → pop_01 띄우기
                setTimeout(function () {
                    showPop01();
                }, 1000);
            }
        }, 1100);

    }, 2000); // 최초 지연
});












document.addEventListener('DOMContentLoaded', function () {
    // .inve_btn_main 클릭 → 대응하는 .kcon_pop 열기
    var btns = document.querySelectorAll('.inve_btn_main');

    btns.forEach(function (btn) {
        btn.addEventListener('click', function (e) {
            e.preventDefault();

            // 1) 부모 .kcon_bg_wrap 찾기
            var wrap = btn.closest('.kcon_bg_wrap');
            if (!wrap || !wrap.id) return;

            // 2) bg01 → 01 이런 식으로 번호만 추출
            var bgId = wrap.id;              // 예: 'bg01'
            var num  = bgId.replace('bg', ''); // '01'

            // 3) 같은 번호의 popxx 찾기
            var targetPopId = 'pop' + num;   // 'pop01'
            var targetPop   = document.getElementById(targetPopId);
            if (!targetPop) return;

            // 4) 모든 팝업에서 is-show 제거
            var allPop = document.querySelectorAll('.kcon_pop');
            allPop.forEach(function (pop) {
                pop.classList.remove('is-show');
            });

            // 5) 해당 팝업에 is-show 추가
            targetPop.classList.add('is-show');
        });
    });

    // 선택: 팝업 닫기 버튼(.close_pop) 처리
    var closeBtns = document.querySelectorAll('.kcon_pop .close_pop');
    closeBtns.forEach(function (btn) {
        btn.addEventListener('click', function () {
            var pop = btn.closest('.kcon_pop');
            if (pop) {
                pop.classList.remove('is-show');
            }
        });
    });
});









document.addEventListener('DOMContentLoaded', function () {
    // ----------------------------------------------------
    // 1) 슬라이더 실제 값 매핑
    //    - 첫 번째: 예상 관람객 (명 단위)
    //    - 두 번째: 투자금액 (억 단위 숫자 그대로)
    // ----------------------------------------------------
    var VISITOR_VALUES = [1000000, 5000000, 10000000]; // 100만, 500만, 1000만
    var VISITOR_DISPLAY = [100, 500, 1000];            // 화면에 "100 / 500 / 1000" 노출

    var AMOUNT_VALUES  = [1, 5, 10];                   // 1, 5, 10억

    function formatNumber(num) {
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }

    // ----------------------------------------------------
    // 2) 각 팝업(kcon_pop) 기준으로 처리 (pop01, pop02 ... 확장 가능)
    // ----------------------------------------------------
    document.querySelectorAll('.kcon_pop').forEach(function (pop) {

        var scrollWraps = pop.querySelectorAll('.con_r .scroll_wrap');
        if (scrollWraps.length < 2) return; // 예상 2개 없으면 스킵

        // 첫 번째 스크롤 박스 (예상 관람객 수)
        var visitorWrap   = scrollWraps[0];
        var visitorRange  = visitorWrap.querySelector('.k-range');
        var visitorNumEl  = visitorWrap.querySelector('.tit .in_num span:first-child'); // "100" 부분
        var visitorLabels = visitorWrap.querySelectorAll('.k-slider-labels span');

        // 두 번째 스크롤 박스 (투자금액)
        var amountWrap   = scrollWraps[1];
        var amountRange  = amountWrap.querySelector('.k-range');
        var amountNumEl  = amountWrap.querySelector('.tit .in_num span:first-child'); // "5" 부분
        var amountLabels = amountWrap.querySelectorAll('.k-slider-labels span');

        // "투자하기" 버튼
        var popBtn = pop.querySelector('.btn .pop_btn');

        if (!visitorRange || !amountRange || !visitorNumEl || !amountNumEl || !popBtn) {
            return;
        }

        // ------------------------------------------------
        // 3) range 기본 옵션 세팅 (0,1,2)
        // ------------------------------------------------
        visitorRange.min = 0;
        visitorRange.max = VISITOR_VALUES.length - 1;
        visitorRange.step = 1;
        if (visitorRange.value === "" || visitorRange.value == null) {
            visitorRange.value = 0;
        }

        amountRange.min = 0;
        amountRange.max = AMOUNT_VALUES.length - 1;
        amountRange.step = 1;
        if (amountRange.value === "" || amountRange.value == null) {
            amountRange.value = 0;
        }

        // ------------------------------------------------
        // 4) 표시 값 / 라벨 상태 업데이트 함수 + 콘솔 로그
        // ------------------------------------------------
        function updateVisitorDisplay(isInit) {
            var idx = parseInt(visitorRange.value, 10) || 0;
            if (idx < 0) idx = 0;
            if (idx >= VISITOR_VALUES.length) idx = VISITOR_VALUES.length - 1;

            // 화면 표시는 100 / 500 / 1000 (만 단위)
            visitorNumEl.textContent = VISITOR_DISPLAY[idx];

            // 실제 값(명 단위)을 data-*에 저장
            var realVal = VISITOR_VALUES[idx];
            visitorRange.dataset.realValue = realVal;

            // 라벨 하이라이트
            visitorLabels.forEach(function (lbl) {
                var liIdx = parseInt(lbl.getAttribute('data-index'), 10);
                if (liIdx === idx) {
                    lbl.classList.add('is-active');
                } else {
                    lbl.classList.remove('is-active');
                }
            });

            // 콘솔 로그
            if (isInit) {
                console.log('[초기] 예상 관람객 선택 값:', realVal, '(index:', idx + ')');
            } else {
                console.log('[변경] 예상 관람객 선택 값:', realVal, '(index:', idx + ')');
            }
        }

        function updateAmountDisplay(isInit) {
            var idx = parseInt(amountRange.value, 10) || 0;
            if (idx < 0) idx = 0;
            if (idx >= AMOUNT_VALUES.length) idx = AMOUNT_VALUES.length - 1;

            // 화면 표시는 1 / 5 / 10 (억)
            var realVal = AMOUNT_VALUES[idx];
            amountNumEl.textContent = realVal;

            // 실제 값 저장
            amountRange.dataset.realValue = realVal;

            // 라벨 하이라이트
            amountLabels.forEach(function (lbl) {
                var liIdx = parseInt(lbl.getAttribute('data-index'), 10);
                if (liIdx === idx) {
                    lbl.classList.add('is-active');
                } else {
                    lbl.classList.remove('is-active');
                }
            });

            // 콘솔 로그
            if (isInit) {
                console.log('[초기] 투자금액 선택 값:', realVal, '억 (index:', idx + ')');
            } else {
                console.log('[변경] 투자금액 선택 값:', realVal, '억 (index:', idx + ')');
            }
        }

        // ------------------------------------------------
        // 5) 최초 1회 초기 디스플레이 & 콘솔 로그
        // ------------------------------------------------
        updateVisitorDisplay(true); // 초기 호출 → [초기] 로그
        updateAmountDisplay(true);  // 초기 호출 → [초기] 로그

        // 슬라이더 움직일 때마다 표시/로그 업데이트
        visitorRange.addEventListener('input', function () {
            updateVisitorDisplay(false);
        });
        amountRange.addEventListener('input', function () {
            updateAmountDisplay(false);
        });

        // ------------------------------------------------
        // 6) "투자하기" 클릭 시 선택 값만 넘기기 (URL은 그대로)
        //    - href는 ../gate02/gate_02_01.html 그대로 사용
        //    - 값은 sessionStorage 에 저장해서 다음 페이지에서 꺼내 씀
        // ------------------------------------------------
        popBtn.addEventListener('click', function (e) {
            // a 태그의 href는 그대로 쓰되, 그 전에 값만 저장
            var vIdx = parseInt(visitorRange.value, 10) || 0;
            var aIdx = parseInt(amountRange.value, 10) || 0;

            if (vIdx < 0) vIdx = 0;
            if (vIdx >= VISITOR_VALUES.length) vIdx = VISITOR_VALUES.length - 1;
            if (aIdx < 0) aIdx = 0;
            if (aIdx >= AMOUNT_VALUES.length) aIdx = AMOUNT_VALUES.length - 1;

            var visitorVal = VISITOR_VALUES[vIdx]; // 1000000 / 5000000 / 10000000
            var amountVal  = AMOUNT_VALUES[aIdx];  // 1 / 5 / 10

            // 콘솔로 최종 값 확인
            console.log('▶ 투자하기 클릭 - 최종 선택 값');
            console.log('   예상 관람객:', visitorVal);
            console.log('   투자금액:', amountVal, '억');

            // sessionStorage에 저장 (다음 페이지에서 사용)
            try {
                sessionStorage.setItem('kcon_visitor', String(visitorVal));
                sessionStorage.setItem('kcon_amount', String(amountVal));
            } catch (err) {
                console.warn('sessionStorage 저장 실패:', err);
            }
            // 여기서는 e.preventDefault() 안 걸고,
            // a 태그 href 그대로 이동
            // (필요하면 SPA면 막고 ajax 등으로 처리하면 됨)
        });
    });
});




</script>